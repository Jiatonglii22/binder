function isSessionStorageAvailable(){try{sessionStorage.setItem("__test","testValue")}catch(e){return!1}return sessionStorage.removeItem("__test"),!0}$(document).on('turbo:load',function(){$("body").removeClass("no-js"),!1!==function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var a=e.indexOf("rv:");return parseInt(e.substring(a+3,e.indexOf(".",a)),10)}return!1}()&&$("body").addClass("ie"),navigator.userAgent.match(/(iPod|iPhone|iPad)/i)&&$("body").addClass("ios");var e=767,t=960,a=350;function n(){var n=function(){$("body").css("overflow","hidden");var e,t=window;return e=null!==window.webkitConvertPointFromNodeToPage||"number"!=typeof window.innerWidth?document.documentElement.clientWidth:t.innerWidth,$("body").removeAttr("style"),e}(),i=window.innerHeight-$("nav.tree h1").outerHeight();$("nav.tree > ul").css("height",i),n<=e?$("body").hasClass("mobile")||$("body").addClass("mobile"):$("body").hasClass("mobile")&&$("body").removeClass("mobile"),n>e&&n<=t?$("body").hasClass("tablet")||$("body").addClass("tablet"):$("body").hasClass("tablet")&&$("body").removeClass("tablet"),$("iframe[src*=youtube], iframe[src*=vimeo], iframe[src*=flickr]").length&&function(){var e;setTimeout(function(){$("iframe[src*=youtube], iframe[src*=vimeo], iframe[src*=flickr], iframe[src*=kaltura], iframe[src*=mediaservices], video").each(function(){$(this).attr("width","100%"),e=Math.round(9*$(this).width())/16,$(this).attr("height",e)})},a)}(),$("body:not(.mobile) header.float + #content .text").length&&function e(){var t=Math.round(($(".hero").height()-$("header").height()-$(".roof").height())/2);$(".hero > .text").each(function(){$(this).css("bottom",Math.round(t-$(this).height()/2))}),$(".js-flickityCustom .hero").length&&$(".flickity-prev-next-button").length?$("#content .js-flickityCustom:first-child .flickity-prev-next-button").css({bottom:t-10,top:"auto"}):setTimeout(function(){e()},50)}()}function i(){var e=$(".js-flickityCustom").flickity();setTimeout(function(){e.flickity("resize")},a)}n(),$(window).resize(function(){n()}),$(".hero").each(function(e){if($(this).find("a").attr("data-position",e+1),$(this).attr("style",$(this).attr("style").replace(/ /g,"%20")),$(this).attr("data-img",$(this).attr("data-img").replace(/ /g,"%20")),$(".hero[data-img]").length&&$("body:not(.mobile)").length){var t="background-image:url("+$(this).attr("data-img")+")";$(this).attr("style",t),$(this).prepend('<img src="'+$(this).attr("data-img")+'" aria-hidden="true" alt="print">')}}),$(".grid.news .img[style]").each(function(){$(this).attr("style",$(this).attr("style").replace(/ /g,"%20")),$(this).prepend('<img src="'+$(this).attr("style").toString().replace("background-image:url(","").replace(")","").replace(/\"/gi,"")+'" aria-hidden="true" alt="print">')}),("ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0)&&$("body").addClass("touch"),$(document.createElement("div")).attr("id","overlay").click(function(){$(this).toggleClass("on"),$(".menu-on").length&&o()}).insertAfter($("#container"));var s=$(".menu-btn").html(),r="&#10005;";function o(e){$("body").toggleClass("menu-on"),$("body").hasClass("menu-on")?($(".menu-btn").html(r).attr("aria-pressed","true"),!0===e&&$("#nav").focus(),isSessionStorageAvailable()&&window.sessionStorage.setItem("shouldAnimateMenu",!1)):($("#content").focus(),$(".menu-btn").html(s).attr("aria-pressed","false"),isSessionStorageAvailable()&&window.sessionStorage.setItem("shouldAnimateMenu",!0)),$(".flickity-viewport").length&&i()}document.addEventListener("keyup",function(e){var t=document.querySelector(".menu-on");"Escape"===e.code&&t&&o()});if($('#hero-nav [href="#menu"]').replaceWith('<button class="menu-button btn ghost"><svg class="icon-menu" width="400" height="400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 400"><rect class="icon-menu__rect icon-menu__rect--1" stroke-width="0" height="50" width="400" y="75" x="0"/><rect class="icon-menu__rect icon-menu__rect--2" stroke-width="0" height="50" width="400" y="175" x="0"/><rect class="icon-menu__rect icon-menu__rect--3" stroke-width="0" height="50" width="400" y="275" x="0"/></svg></button>'),$(".menu-button").click(function(){o(!0)}),$("footer nav ul").length?($("nav ul li ul").length&&($("nav ul li").has("ul").addClass("parent"),$(".parent").has(".active").addClass("ancestor")),$("footer nav").clone().removeAttr("id").attr("aria-hidden","true").appendTo("header"),$("header nav ul ul, header .secondary").remove(),$("header nav li:gt(9)").remove(),$(".hero").length&&$("header nav").addClass("b"),$("footer nav").addClass("tree invert").attr("tabindex","0").insertAfter("#container"),$("nav.tree > ul").wrap("<div>"),$("nav.tree .ancestor, nav.tree .active").addClass("expand"),$('<a href="#content" id="skipnav" class="btn">Skip to main content</a>').insertBefore("header"),$(".tree a").focus(function(){$("body").addClass("menu-on"),$(".menu-btn").html(r),$(".flickity-viewport").length&&i()}),$("form.search, #sitename h1").clone().prependTo(".tree"),$(".menu-btn").clone().prependTo(".tree"),$(".roof.invert").length&&$("nav.tree").addClass("b"),$("nav.tree li li.active, nav.tree li.parent.active, nav.tree li.secondary.active").length&&!$(".tablet, .mobile").length?isSessionStorageAvailable()&&"true"===window.sessionStorage.getItem("shouldAnimateMenu")?setTimeout(function(){o()},10):($("#container").css({transition:"none"}),o(),setTimeout(function(){$("#container").removeAttr("style").focus()},a)):isSessionStorageAvailable()&&window.sessionStorage.setItem("shouldAnimateMenu","true"),$(".menu-btn").click(function(){o(!0)}),$("nav.tree li.expand").length&&$("nav.tree ul").scrollTop($("nav.tree li.expand").position().top),$(".tree .parent > a").each(function(){var e="toggle "+$(this).text()+" section",t="false";$(this).parent().hasClass("expand")&&(t="true"),$(document.createElement("button")).attr({class:"arrow","aria-pressed":t}).text(e).insertAfter($(this))}),$("button.arrow").click(function(){"true"===$(this).attr("aria-pressed")?$(this).attr("aria-pressed","false"):$(this).attr("aria-pressed","true"),$(this).parent().stop().toggleClass("expand"),$(this).next().stop().slideToggle(a),setTimeout(function(){},a)})):$(".menu-btn").remove(),$(".search input[name=site]").length&&$(".search input[placeholder]").focus(function(){$(".searchSite").fadeIn(300)}),$("body:not(.mobile):not(.tablet):not(.touch) .tubular").length){var l={videoId:$(".tubular").attr("data-vid"),mute:!0,repeat:!0,width:"100%",wrapperZIndex:1,start:1};$(".tubular").tubular(l),setTimeout(function(){$("#tubular-container").fadeTo(1e3,0,function(){setTimeout(function(){$("#tubular-container, #tubular-shield").remove()},2e3)})},3e5)}if($("span.protect").replaceWith(function(){var e=$.trim($(this).text().replace("(through)","@"));return $(this).hasClass("Envelope")?'<a class="icon email" title="Email" href="mailto:'+e+'" target="_blank">Email</a>':'<a class="icon email" href="mailto:'+e+'" target="_blank">Email</a>'}),$(".loadmore a").click(function(){var e,t="";for($(this).parent().parent().children("div .hide").each(function(){(t=$(this).attr("data-img"))&&(t=t.replace(/ /g,"%20"),$(this).find(".img").each(function(){$(this).css("background-image","url("+t+")")}))}),e=0;e<12;e++)$(this).parent().parent().children(".hide").filter(":first").removeClass("hide");$(this).parent().parent().children(".hide").length||$(this).parent().hide()}),$("p.tags").length){$("p.tags").prepend("<strong>Categories:</strong> ").addClass("small"),$("p.tags a").each(function(){$(this).replaceWith("<span>"+$(this).text()+", </span>")});var d=$("p.tags span:last-child").html().toString();d=d.replace(/,\s*$/,""),$("p.tags span:last-child").html(d)}$("#content > .tall").length&&($(document.createElement("a")).attr({class:"scrolldown-hidden-anchor",id:"scrolldown-hidden-anchor",tabindex:"-1","aria-hidden":"true"}).css({position:"absolute",top:"100vh"}).appendTo("#content > .tall"),$(document.createElement("a")).html("&#9662;").attr({class:"scrolldown",href:"#scrolldown-hidden-anchor",id:"scrolldown","aria-label":"scroll down"}).appendTo("#content > .tall")),$(document.createElement("a")).html("&#9652;").attr({class:"scrolltop btn",href:"#","aria-hidden":"true"}).appendTo("#container"),$(window).scroll(function(){$(document).scrollTop()>2*$(window).height()?$(".scrolltop").addClass("on"):$(".scrolltop").removeClass("on")});function c(){$("div:not(.grid) > .collapsed").nextUntil(".collapsed").hide(),$(".grid > .collapsed").siblings().hide(),$("h1.collapsed").parent().parent().nextUntil(":not(.stacked)").hide(),$(".collapsed").addClass("pointer").wrapInner('<a href="javascript:void(0);"></a>')}if($(".collapsed").length&&($("iframe").length?setTimeout(function(){c()},a+20):c()),window.location.hash.length){var u=window.location.hash;$(u).hasClass("collapsed")?$(u).addClass("open").next().slideDown(250):$(u).hasClass("grid")&&$(u+" > h1.collapsed").length?$(u+" > h1").addClass("open").siblings().stop().slideToggle(250):$(u).hasClass("content")&&$(u+" + .stacked").length&&($(u+" > div > h1").hasClass("open")||($(u+" > div > h1").addClass("open"),$(u).nextUntil(":not(.stacked)").slideToggle(250))),setTimeout(function(){$("html, body").animate({scrollTop:$(u).offset().top},400)},250)}$("div:not(.grid) > .collapsed").click(function(){$(this).nextUntil(".collapsed").stop().slideToggle(250),$(this).toggleClass("open")}),$(".grid > .collapsed").click(function(){$(this).siblings().stop().slideToggle(250),$(this).toggleClass("open")}),$(".content > div > h1.collapsed").click(function(){$(this).parent().parent().nextUntil(":not(.stacked)").slideToggle(250)}),$(".contact > .address").hide(),$(".inquiry").click(function(){$(this).next().stop().slideToggle(250),$(this).toggleClass("open")}),$('a[href^="#"]:not(#skipnav):not(.loadmore)').each(function(){var e=$(this).attr("href");$(this).attr({href:"javascript:void(0);","data-jump":e})}),$("#skipnav").click(function(){$("#content").focus()}),$('a[data-jump]:not(a[data-jump="#"])').click(function(){var e=$(this).attr("data-jump");$(e).hasClass("collapsed")?$(e).hasClass("open")||($(e).addClass("open"),$(e).next().slideDown(250)):$(e).hasClass("grid")&&$(e+" > h1.collapsed").length?$(e+" > h1").hasClass("open")||($(e+" > h1").addClass("open"),$(e+" > h1").siblings().stop().slideToggle(250)):$(e).hasClass("content")&&$(e+" > div .collapsed").length&&($(e+" > div > h1").hasClass("open")||($(e+" > div > h1").addClass("open"),$(e).nextUntil(":not(.stacked)").slideToggle(250))),$("html, body").animate({scrollTop:$(e).offset().top},400,function(){$(e).find(".js-list > div:first-child").find("h2").focus()})}),$('a[data-jump="#"]').not(".no-jump").click(function(){$("html, body").animate({scrollTop:$("html").offset().top},400)}),$("span[style]:contains('Save')").remove(),$("span[style]").removeAttr("style"),$("body").prepend('<img id="wordmarkPrint" alt="" src="//www.cmu.edu/common/standard-v6/images/cmu-wordmark.png" />'),$("#js-current-year").text((new Date).getFullYear())});var RSSMODULE=function(e){var t='<div class="spinner"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>';function a(e,a,n,i,s,r,o){$("."+o).append(t),e=e.replace(/&/g,"%26"),jQuery.ajax({url:"/cmsint/rss?url="+e,type:"get",success:function(e){$(".spinner").remove(),a(e,n,i,s,r,o)}}).fail(function(e,t){$(".spinner").remove(),function(e){$(".internal-errors."+e).append('<span class="error">To preview the feed, publish this page to staging and view on cms-staging.andrew.cmu.edu.</span>')}(o)})}function n(e,t){var a=new Date(e);return t?{0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday",7:"Sunday"}[a.getDay()]+", "+{0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"}[a.getMonth()]+" "+a.getDate()+", "+a.getFullYear():{day:a.getDate(),month:{0:"Jan",1:"Feb",2:"Mar",3:"Apr",4:"May",5:"Jun",6:"Jul",7:"Aug",8:"Sep",9:"Oct",10:"Nov",11:"Dec"}[a.getMonth()]}}function i(e){return e.replace(/<[^>]*>/g," ").replace(/\s{2,}/g," ").trim()}function s(e){var t=e.getElementsByTagName("media:content"),a=t&&t[0]&&t[0].getAttribute("url");if(a)return a;var n=$(e).find("description").text(),i=document.createElement("html");i.innerHTML=n;var s=$(i).find("img").attr("src");return s||null}function r(e,t,a,r,o,l){/[0-9]/g.test(t)||(t=null);var d,c=$(e).find("channel").children(),u=$(c).filter(function(e,t){return"item"===t.tagName}).map(function(e,t){var a=t.getElementsByTagName("title")[0],n=t.getElementsByTagName("link")[0],i=t.getElementsByTagName("description")[0],r=t.getElementsByTagName("pubDate")[0];return{title:a&&a.textContent,link:n&&n.textContent,description:i&&i.textContent,pubDate:r&&r.textContent,descriptionTextOnly:$(t).find("description").text(),image_url:s(t)}}),h=u&&u.slice(0,t||6);if(r&&"grid"===r)d="";else if("mixed"===r)d="<ul>";else if("news"===r){var m=o?o.heading:null;if(d=document.createElement("div"),$(d).addClass("grid news "+a+" column"+(o&&o.columns||3)+" "+(o&&o.bgImage)),m&&""!==m){var p="<h1>"+m+"</h1>";$(d).append(p)}""!==o.optionalId&&$(d).attr("id",o.optionalId)}else $("."+l).addClass(a).addClass("events"),d=o&&o.heading?"<h1>"+o.heading+"</h1><ul>":"<ul>";function g(){var e=o.moreLink,t=o.moreLink.url;if(e&&""!==t){var a=e.newWin?'target="_blank"':"";d+='<p><a class="btn ghost" href="'+t+'" '+a+">More events</a></p>"}}if($(h).each(function(e,t){var a,s=t&&t.description;if("news"!==r)try{a=(chrono&&chrono.parse(i(s)))[0].start.date()}catch(e){try{a=(chrono&&chrono.parse(i(t.pubDate)))[0].start.date()}catch(e){console.log("Date Parsing Error",e),a=""}}else a=i(t.pubDate);if("grid"===r){var l=n(a,!0),c=o&&o.newWin?'<a href="'+t.link+'" target="_blank">':'<a href="'+t.link+'">';d+="<div>"+c+'<small class="icon-cal">'+l+"</small> <h2>"+t.title+"</h2></a></div>"}else if("news"===r)$(d).append(function(e,t){var a='<a href="XX_LINK"><div aria-label="XX_ALT" class="img" role="img" style="background-image:url(XX_IMAGE_URL)"><img src="XX_IMAGE_URL" aria-hidden="true" alt="print"> </div><small>XX_DATE</small> <h2>XX_TITLE</h2> <span>XX_DESC</span></a>';a=a.replace("XX_LINK",e.link).replace("XX_ALT",e.title).replace(/XX_IMAGE_URL/g,e.image_url).replace("XX_DATE",n(e.pubDate,!0)).replace("XX_TITLE",e.title).replace("XX_DESC",i(e.descriptionTextOnly));var s=document.createElement("div");return s.innerHTML=a,t.newWin&&$(s).find("a").attr("target","_blank"),t.includePubDate||$(s).find("small").remove(),t.includeSummary||$(s).find("span").remove(),t.includeImages||($(s).find("img").remove(),$(s).find("div.img").remove(),$(s).find(".img").attr("style","")),e.image_url&&""!=e.image_url||($(s).find("img").remove(),$(s).find(".img").attr("style","")),s}(t,o));else{l=n(a),c=o&&o.newWin?'<a href="'+t.link+'" target="_blank">':'<a href="'+t.link+'">';d+="<li>"+c+"<span><span>"+l.month+"</span>"+l.day+"</span>"+t.title+"</a></li>"}}),"grid"===r){var f=$($("."+l));f.addClass("boxes news "+a),f.append(d)}else"news"===r?$("."+l).append(d):"mixed"===r?(g(),d+="</ul>",$("."+l).append(d)):(g(),d+="</ul>",$(".sidebar ."+l).append(d))}return e.detectAndParseFeed=function(e,t,n,i,s,o){a(e,r,t,n,i,s,o)},e}(RSSMODULE||{});function OnPageFiltering(e){var t,a=[],n=function(e){try{var t=window.localStorage.getItem(e);if(t){var a=JSON.parse(t);t=a}}catch(e){console.warn(e)}return t}(e);function i(n){var i=n.target.attributes,s=n.target.value,r=i.name.value,l=1*(i["data-id"].value||"").split("-")[1],d=s.replace(/ /g,"");t=i["data-section-id"].value||"","filter-name"!==r&&(a[l]=d),o(t),function(e){var t=$('div[data-index-id="'+e+'"] .filter'),a=[];t.each(function(e,t){var n={section:$(t).attr("data-section-id"),name:$(t).attr("name"),value:$(t).find(":selected").val()};a.push(n)});try{var n=JSON.stringify(a);window.localStorage.setItem(e,n)}catch(e){console.warn(e)}}(e)}function s(t){t.stopPropagation(),a=[],filterByName="none",$('div[data-index-id="'+e+'"]').find(".filter").prop("selectedIndex",0).change(),r(e)}function r(e){var t=$("[data-filter-id='"+e+"'] .filterable:not(.hide)"),a=$("#results-message-"+e);if(t.length){var n=t.length,i=$(a).attr("data-content-type")||"";n>1?$(a).text(n+" "+i+"s displayed."):$(a).text(n+" "+i+" displayed.")}else $(a).text("Sorry, no results to display."),$(".loadmore").addClass("hide")}function o(t){var n=$("#"+t).find("[data-categories]"),i=$("select[name='filter-name'][data-section-id='"+t+"']").val()||"none";$(".no-jump").attr("data-jump",""),n.each(function(e,t){var n,s=$(t).attr("data-categories"),r=$(t).attr("data-lastname"),o=(n=r)&&n.length?n.substring(0,1).toLowerCase():"";!function(e){for(var t=0,n=0,i=e.split("|"),s=0;s<a.length;s++){void 0===a[s]&&(a[s]="none"),"none"!==a[s]&&n++;for(var r=a[s].trim().toLowerCase(),o=0;o<i.length;o++)i[o].trim().toLowerCase().replace(/ /g,"")===r&&t++}return n===t}(s)||i!==o&&"none"!==i?$(t).parents(".filterable").addClass("hide"):($(t).parents(".filterable").removeClass("hide"),$(".loadmore").addClass("hide"))}),r(e)}function l(){$("div[data-index-id="+e+"]").find("select").change(i),$("div[data-index-id="+e+"]").find(".js-clear-all").click(s)}n&&(n.forEach(function(e){var t=e.name,a=e.value,n=e.section;$('select[data-section-id="'+n+'"][name="'+t+'"] option[value="'+a+'"]').attr("selected","selected")}),setTimeout(function(){$("select").change()},100)),$("div[data-index-id="+e+"]").find(".search").on("keyup",function(){setTimeout(function(){o(t)},10)}),l(),this.selectHandler=i,this.clearAllFilters=s,this.bindAllSelectors=l}document.addEventListener("DOMContentLoaded",function(e){$('input[name="q"]').val("");var t=$(".js-onpage-filtering");if($.each(t,function(e,t){var a=$(t).attr("data-index-id"),n=$("div[data-index-id='"+a+"']"),i=(n.find(".js-clear-all"),n.find(".search"),new OnPageFiltering(a),$(n).find("label")),s="";$.each(i,function(e,t){var a=$(t).text();s+=a,e!==i.length-1&&(s+=", ")}),$('[data-index-id ^= "bio-index"]').length&&(s=s.replace("Last Name","First Letter of Last Name"));var r=$("[data-accessibility-id='"+a+"']").text(),o=s.split(","),l=(o.shift(),r.trim()+","+o.join(","));$("[data-accessibility-id='"+a+"']").text(l)}),"undefined"!=typeof List){var a={valueNames:["name"],listClass:"js-list"},n=$(".section-id");$.each(n,function(e,t){var n=$(t).attr("id"),i=$(t).attr("data-filter-id"),s=$("[data-index-id='"+i+"']"),r=new List(n,a),o=s.find(".search"),l=s.find(".js-clear-all");$(o).on("keyup",function(){var e=$(this).val();r.search(e)}),l.click(function(){o.val(""),r.search()})})}});
